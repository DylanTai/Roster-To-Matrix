# Excel Conversion Utility

This repository holds a tiny Python tool that reads an Excel workbook and writes
it back out (optionally tweaking headers or removing blank rows). The same
conversion logic powers both a command-line interface and a minimal Tk GUI so a
non-technical teammate can select files without typing paths.

## Setup

1. Install Python **3.12** with Tk support so the GUI can import `_tkinter`
   (e.g., `brew install python@3.12 python-tk@3.12` or use the python.org 3.12
   installer).
2. Create a virtual environment with that interpreter and install dependencies:

```bash
python3.12 -m venv .venv
source .venv/bin/activate
python -m pip install -r requirements.txt
```
3. *(Optional)* Install `tkinterdnd2` if you want drag-and-drop file selection in
   the GUI:

```bash
pip install tkinterdnd2
```

## Command-line usage

```bash
python excel_converter.py input.xlsx output.xlsx [--uppercase-headers] [--drop-empty-rows] [--courses path/to/courses.txt]
```

- If you provide both positional arguments, the tool writes to the path you
  specify.
- If you omit the output file, the converter saves alongside the input file
  using the pattern `YYMMDD-HHMM-<OriginalName>.xlsx` (e.g.,
  `251103-2342-CourseAssignment.xlsx`).
- Leaving out both arguments launches the interactive prompts described below.
- `--courses` overrides the default `courses.txt` path (handy if you keep
  multiple catalogs).

### Prompt-driven mode

If you omit the positional arguments, the script walks you through selecting
directories and filenames:

1. When asked for a directory, enter a relative path using `/`, `\\`, or `..`
   (e.g., `../Downloads`). Any other input--or simply pressing Enter--defaults to
   the current working directory.
2. Provide the exact workbook filename that lives inside that directory.
3. As soon as the input file is confirmed, the tool previews the autogenerated
   output path with the timestamped filename shown above.

## Course assignment sheet

The converter reads only the workbook's first sheet (e.g., your `2025-26` roster)
and writes a *new* workbook that contains a single `CourseAssignment` sheet:

- Each row lists a course pulled from `courses.txt` (one name per line).
- Columns after the first correspond to each `LocName`, ordered by first
  appearance in the roster.
- Cell contents are the date range in `yy/mm/dd - yy/mm/dd` format plus the
  `JobStatus` (e.g., `25/09/18 - 25/12/18 CANCELED`). Subsequent matches for the
  same course/location are stacked on separate lines.

This mirrors the sample tab you provided but fills in the date range so it never
has to be entered manually. Since only the generated sheet is written, the
output file stays small and focused.

### Managing the course list

`courses.txt` (bundled next to `excel_converter.py` or the PyInstaller exe)
controls both the set and the order of courses that appear in the generated
matrix. Edit the file whenever your catalog changes--any blank lines are ignored,
and the converter keeps the names exactly as written. If a course listed in
`courses.txt` is missing from the incoming roster, its row still appears so you
can spot gaps quickly. When you need an alternate catalog, point the CLI
(`--courses`) or GUI (second input) at a different text file.

## Simple GUI

```bash
python excel_converter.py --gui
```

Click **Browse...** to select the source workbook; the output path is filled in
automatically using the timestamped naming convention. Use the second
**Browse...** button (or drag a text file onto the input if `tkinterdnd2` is
installed) to pick the `courses.txt` file, then press **Convert**. A message box
confirms success or shows any errors (missing files, locked workbook, etc.).

## Build a standalone app

To ship a double-clickable executable, package the script with PyInstaller. You
must build on each target OS separately (Mac builds the `.app`, Windows builds
the `.exe`).

### macOS

```bash
pip install pyinstaller
pyinstaller --name RosterToMatrix --windowed --onefile excel_converter.py
```

### Windows (Command Prompt)

```bat
py -3.12 -m venv .venv
.venv\Scripts\activate
pip install -r requirements.txt
pip install pyinstaller
pyinstaller --name RosterToMatrix --windowed --onefile excel_converter.py
```

PyInstaller writes the bundled binary inside `dist/`. Zip the corresponding
`RosterToMatrix` folder and share it; recipients do not need Python installed.
Re-run the command whenever code changes, or edit the generated
`RosterToMatrix.spec` for extra data files, icons, or custom output paths.

## Run the packaged executable

### Windows (.exe)

1. Double-click `RosterToMatrix.exe`. If SmartScreen appears, choose **More
   info** â†’ **Run anyway** (you only need to do this once per publisher).
2. When the GUI opens, click **Browse...** (or drag-and-drop if supported) to
   select the roster workbook and the courses list, then press **Convert**.
3. Find the timestamped output workbook next to the source roster unless you
   browsed to a different destination.

### macOS (.app)

1. On first launch, right-click the app and choose **Open** to bypass Gatekeeper
   warnings for unsigned binaries.
2. Use the same GUI flow as Windows: pick the roster workbook and `courses.txt`,
   then click **Convert**. The output file is created alongside the input.

Neither platform build requires Python once packaged, but both expect
`courses.txt` to live next to the executable/bundle unless you browse to a
different list inside the UI.

## Next steps

* Add your real business logic inside `convert_workbook`.
* Ship the tool as a standalone app via `pyinstaller` or `briefcase` once the
  workflow is finalized.
